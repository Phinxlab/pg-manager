{"id":"Focm","dependencies":[{"name":"/home/alberto/Documents/phinx-public/pg-manager/package.json","includedInParent":true,"mtime":1570477508668}],"generated":{"js":"const Global = require('@phinxlab/config-manager');\n\nconst Log = new (require('@phinxlab/log-manager'))('PGConnection');\n\nconst {\n  Client,\n  Pool\n} = require('pg');\n\nclass PGConnection {\n  static registerConfig(cfg) {\n    Global.addConfig(\"PG_CONNECTION\", cfg);\n  }\n\n  constructor() {\n    this.adujstTypes();\n  }\n\n  adujstTypes() {\n    // 0700,701,1021,1022,1231,1700\n    var types = require('pg').types;\n\n    function toNumber(val) {\n      return parseFloat(val);\n    }\n\n    ;\n    types.setTypeParser(700, toNumber);\n    types.setTypeParser(701, toNumber);\n    types.setTypeParser(1021, toNumber);\n    types.setTypeParser(1022, toNumber);\n    types.setTypeParser(1231, toNumber);\n    types.setTypeParser(1700, toNumber);\n    types.setTypeParser(20, function (val) {\n      return parseInt(val);\n    });\n  }\n\n  async tx(callback) {\n    const pool = new Pool(Global.PG_CONNECTION);\n    const client = await pool.connect();\n\n    try {\n      Log.info('Connection to database');\n      Log.info('Begining a new transaction');\n      await client.query('BEGIN');\n\n      try {\n        Log.info('Waiting for the operations to be done');\n        client.execute = client.query.bind(client);\n        const response = await callback(client);\n        Log.info('Commiting the operations: ', response);\n        await client.query('COMMIT');\n        return response;\n      } catch (e) {\n        Log.error('Failed to execute query');\n        Log.error(e);\n        await client.query('ROLLBACK');\n        const message = e.message ? e.message : e.toString();\n        throw new Error(message, message);\n      }\n    } catch (e) {\n      Log.error('Failed to begin transactiom');\n      Log.error(e);\n      const message = e.message ? e.message : e.toString();\n      throw new Error(message, message);\n    } finally {\n      Log.info('Killing connection tx');\n      client.release();\n    }\n  }\n\n  async execute(query, params = []) {\n    const client = new Client(Global.PG_CONNECTION);\n\n    try {\n      await client.connect();\n      const res = await client.query(query, params);\n      return res;\n    } catch (e) {\n      Log.error(e.message);\n      throw new Error('Failed to execute query', e.message);\n    } finally {\n      await client.end();\n    }\n  }\n\n}\n\nmodule.exports = PGConnection;"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":1,"column":0},"source":"index.js","original":{"line":1,"column":0}},{"name":"Global","generated":{"line":1,"column":6},"source":"index.js","original":{"line":1,"column":6}},{"generated":{"line":1,"column":12},"source":"index.js","original":{"line":1,"column":12}},{"name":"require","generated":{"line":1,"column":15},"source":"index.js","original":{"line":1,"column":15}},{"generated":{"line":1,"column":22},"source":"index.js","original":{"line":1,"column":22}},{"generated":{"line":1,"column":23},"source":"index.js","original":{"line":1,"column":23}},{"generated":{"line":1,"column":49},"source":"index.js","original":{"line":1,"column":22}},{"generated":{"line":1,"column":50},"source":"index.js","original":{"line":1,"column":0}},{"generated":{"line":3,"column":0},"source":"index.js","original":{"line":2,"column":0}},{"name":"Log","generated":{"line":3,"column":6},"source":"index.js","original":{"line":2,"column":6}},{"generated":{"line":3,"column":9},"source":"index.js","original":{"line":2,"column":9}},{"generated":{"line":3,"column":12},"source":"index.js","original":{"line":2,"column":12}},{"name":"require","generated":{"line":3,"column":17},"source":"index.js","original":{"line":2,"column":17}},{"generated":{"line":3,"column":24},"source":"index.js","original":{"line":2,"column":24}},{"generated":{"line":3,"column":25},"source":"index.js","original":{"line":2,"column":25}},{"generated":{"line":3,"column":48},"source":"index.js","original":{"line":2,"column":24}},{"generated":{"line":3,"column":49},"source":"index.js","original":{"line":2,"column":12}},{"generated":{"line":3,"column":51},"source":"index.js","original":{"line":2,"column":51}},{"generated":{"line":3,"column":65},"source":"index.js","original":{"line":2,"column":12}},{"generated":{"line":3,"column":66},"source":"index.js","original":{"line":2,"column":0}},{"generated":{"line":5,"column":0},"source":"index.js","original":{"line":3,"column":0}},{"generated":{"line":5,"column":6},"source":"index.js","original":{"line":3,"column":6}},{"name":"Client","generated":{"line":6,"column":0},"source":"index.js","original":{"line":3,"column":7}},{"name":"Client","generated":{"line":6,"column":2},"source":"index.js","original":{"line":3,"column":7}},{"generated":{"line":6,"column":8},"source":"index.js","original":{"line":3,"column":6}},{"name":"Pool","generated":{"line":7,"column":0},"source":"index.js","original":{"line":3,"column":15}},{"name":"Pool","generated":{"line":7,"column":2},"source":"index.js","original":{"line":3,"column":15}},{"generated":{"line":8,"column":0},"source":"index.js","original":{"line":3,"column":6}},{"name":"require","generated":{"line":8,"column":4},"source":"index.js","original":{"line":3,"column":23}},{"generated":{"line":8,"column":11},"source":"index.js","original":{"line":3,"column":30}},{"generated":{"line":8,"column":12},"source":"index.js","original":{"line":3,"column":31}},{"generated":{"line":8,"column":16},"source":"index.js","original":{"line":3,"column":30}},{"generated":{"line":8,"column":17},"source":"index.js","original":{"line":3,"column":0}},{"generated":{"line":10,"column":0},"source":"index.js","original":{"line":5,"column":0}},{"name":"PGConnection","generated":{"line":10,"column":6},"source":"index.js","original":{"line":5,"column":6}},{"generated":{"line":10,"column":18},"source":"index.js","original":{"line":5,"column":0}},{"generated":{"line":10,"column":19},"source":"index.js","original":{"line":5,"column":19}},{"generated":{"line":11,"column":0},"source":"index.js","original":{"line":7,"column":4}},{"name":"registerConfig","generated":{"line":11,"column":9},"source":"index.js","original":{"line":7,"column":11}},{"generated":{"line":11,"column":23},"source":"index.js","original":{"line":7,"column":4}},{"name":"cfg","generated":{"line":11,"column":24},"source":"index.js","original":{"line":7,"column":26}},{"generated":{"line":11,"column":27},"source":"index.js","original":{"line":7,"column":4}},{"generated":{"line":11,"column":29},"source":"index.js","original":{"line":7,"column":31}},{"name":"Global","generated":{"line":12,"column":0},"source":"index.js","original":{"line":8,"column":8}},{"name":"Global","generated":{"line":12,"column":4},"source":"index.js","original":{"line":8,"column":8}},{"generated":{"line":12,"column":10},"source":"index.js","original":{"line":8,"column":14}},{"name":"addConfig","generated":{"line":12,"column":11},"source":"index.js","original":{"line":8,"column":15}},{"generated":{"line":12,"column":20},"source":"index.js","original":{"line":8,"column":8}},{"generated":{"line":12,"column":21},"source":"index.js","original":{"line":8,"column":25}},{"generated":{"line":12,"column":36},"source":"index.js","original":{"line":8,"column":8}},{"name":"cfg","generated":{"line":12,"column":38},"source":"index.js","original":{"line":8,"column":42}},{"generated":{"line":12,"column":41},"source":"index.js","original":{"line":8,"column":8}},{"generated":{"line":13,"column":0},"source":"index.js","original":{"line":9,"column":5}},{"name":"constructor","generated":{"line":15,"column":0},"source":"index.js","original":{"line":11,"column":4}},{"name":"constructor","generated":{"line":15,"column":2},"source":"index.js","original":{"line":11,"column":4}},{"generated":{"line":15,"column":13},"source":"index.js","original":{"line":11,"column":15}},{"generated":{"line":15,"column":16},"source":"index.js","original":{"line":11,"column":18}},{"generated":{"line":16,"column":0},"source":"index.js","original":{"line":12,"column":8}},{"name":"adujstTypes","generated":{"line":16,"column":9},"source":"index.js","original":{"line":12,"column":13}},{"generated":{"line":16,"column":20},"source":"index.js","original":{"line":12,"column":8}},{"generated":{"line":17,"column":0},"source":"index.js","original":{"line":13,"column":5}},{"name":"adujstTypes","generated":{"line":19,"column":0},"source":"index.js","original":{"line":15,"column":4}},{"name":"adujstTypes","generated":{"line":19,"column":2},"source":"index.js","original":{"line":15,"column":4}},{"generated":{"line":19,"column":13},"source":"index.js","original":{"line":15,"column":15}},{"generated":{"line":19,"column":16},"source":"index.js","original":{"line":15,"column":18}},{"generated":{"line":20,"column":0},"source":"index.js","original":{"line":16,"column":8}},{"generated":{"line":21,"column":0},"source":"index.js","original":{"line":17,"column":8}},{"name":"types","generated":{"line":21,"column":8},"source":"index.js","original":{"line":17,"column":12}},{"generated":{"line":21,"column":13},"source":"index.js","original":{"line":17,"column":17}},{"name":"require","generated":{"line":21,"column":16},"source":"index.js","original":{"line":17,"column":20}},{"generated":{"line":21,"column":23},"source":"index.js","original":{"line":17,"column":27}},{"generated":{"line":21,"column":24},"source":"index.js","original":{"line":17,"column":28}},{"generated":{"line":21,"column":28},"source":"index.js","original":{"line":17,"column":27}},{"generated":{"line":21,"column":29},"source":"index.js","original":{"line":17,"column":20}},{"name":"types","generated":{"line":21,"column":30},"source":"index.js","original":{"line":17,"column":34}},{"generated":{"line":21,"column":35},"source":"index.js","original":{"line":17,"column":8}},{"generated":{"line":23,"column":0},"source":"index.js","original":{"line":19,"column":8}},{"name":"toNumber","generated":{"line":23,"column":13},"source":"index.js","original":{"line":19,"column":17}},{"generated":{"line":23,"column":21},"source":"index.js","original":{"line":19,"column":8}},{"name":"val","generated":{"line":23,"column":22},"source":"index.js","original":{"line":19,"column":26}},{"generated":{"line":23,"column":25},"source":"index.js","original":{"line":19,"column":8}},{"generated":{"line":23,"column":27},"source":"index.js","original":{"line":19,"column":31}},{"generated":{"line":24,"column":0},"source":"index.js","original":{"line":20,"column":12}},{"name":"parseFloat","generated":{"line":24,"column":13},"source":"index.js","original":{"line":20,"column":19}},{"generated":{"line":24,"column":23},"source":"index.js","original":{"line":20,"column":29}},{"name":"val","generated":{"line":24,"column":24},"source":"index.js","original":{"line":20,"column":30}},{"generated":{"line":24,"column":27},"source":"index.js","original":{"line":20,"column":29}},{"generated":{"line":24,"column":28},"source":"index.js","original":{"line":20,"column":12}},{"generated":{"line":25,"column":0},"source":"index.js","original":{"line":21,"column":9}},{"generated":{"line":27,"column":0},"source":"index.js","original":{"line":21,"column":9}},{"name":"types","generated":{"line":28,"column":0},"source":"index.js","original":{"line":23,"column":8}},{"name":"types","generated":{"line":28,"column":4},"source":"index.js","original":{"line":23,"column":8}},{"generated":{"line":28,"column":9},"source":"index.js","original":{"line":23,"column":13}},{"name":"setTypeParser","generated":{"line":28,"column":10},"source":"index.js","original":{"line":23,"column":14}},{"generated":{"line":28,"column":23},"source":"index.js","original":{"line":23,"column":8}},{"generated":{"line":28,"column":24},"source":"index.js","original":{"line":23,"column":28}},{"generated":{"line":28,"column":27},"source":"index.js","original":{"line":23,"column":8}},{"name":"toNumber","generated":{"line":28,"column":29},"source":"index.js","original":{"line":23,"column":33}},{"generated":{"line":28,"column":37},"source":"index.js","original":{"line":23,"column":8}},{"name":"types","generated":{"line":29,"column":0},"source":"index.js","original":{"line":24,"column":8}},{"name":"types","generated":{"line":29,"column":4},"source":"index.js","original":{"line":24,"column":8}},{"generated":{"line":29,"column":9},"source":"index.js","original":{"line":24,"column":13}},{"name":"setTypeParser","generated":{"line":29,"column":10},"source":"index.js","original":{"line":24,"column":14}},{"generated":{"line":29,"column":23},"source":"index.js","original":{"line":24,"column":8}},{"generated":{"line":29,"column":24},"source":"index.js","original":{"line":24,"column":28}},{"generated":{"line":29,"column":27},"source":"index.js","original":{"line":24,"column":8}},{"name":"toNumber","generated":{"line":29,"column":29},"source":"index.js","original":{"line":24,"column":33}},{"generated":{"line":29,"column":37},"source":"index.js","original":{"line":24,"column":8}},{"name":"types","generated":{"line":30,"column":0},"source":"index.js","original":{"line":25,"column":8}},{"name":"types","generated":{"line":30,"column":4},"source":"index.js","original":{"line":25,"column":8}},{"generated":{"line":30,"column":9},"source":"index.js","original":{"line":25,"column":13}},{"name":"setTypeParser","generated":{"line":30,"column":10},"source":"index.js","original":{"line":25,"column":14}},{"generated":{"line":30,"column":23},"source":"index.js","original":{"line":25,"column":8}},{"generated":{"line":30,"column":24},"source":"index.js","original":{"line":25,"column":28}},{"generated":{"line":30,"column":28},"source":"index.js","original":{"line":25,"column":8}},{"name":"toNumber","generated":{"line":30,"column":30},"source":"index.js","original":{"line":25,"column":34}},{"generated":{"line":30,"column":38},"source":"index.js","original":{"line":25,"column":8}},{"name":"types","generated":{"line":31,"column":0},"source":"index.js","original":{"line":26,"column":8}},{"name":"types","generated":{"line":31,"column":4},"source":"index.js","original":{"line":26,"column":8}},{"generated":{"line":31,"column":9},"source":"index.js","original":{"line":26,"column":13}},{"name":"setTypeParser","generated":{"line":31,"column":10},"source":"index.js","original":{"line":26,"column":14}},{"generated":{"line":31,"column":23},"source":"index.js","original":{"line":26,"column":8}},{"generated":{"line":31,"column":24},"source":"index.js","original":{"line":26,"column":28}},{"generated":{"line":31,"column":28},"source":"index.js","original":{"line":26,"column":8}},{"name":"toNumber","generated":{"line":31,"column":30},"source":"index.js","original":{"line":26,"column":34}},{"generated":{"line":31,"column":38},"source":"index.js","original":{"line":26,"column":8}},{"name":"types","generated":{"line":32,"column":0},"source":"index.js","original":{"line":27,"column":8}},{"name":"types","generated":{"line":32,"column":4},"source":"index.js","original":{"line":27,"column":8}},{"generated":{"line":32,"column":9},"source":"index.js","original":{"line":27,"column":13}},{"name":"setTypeParser","generated":{"line":32,"column":10},"source":"index.js","original":{"line":27,"column":14}},{"generated":{"line":32,"column":23},"source":"index.js","original":{"line":27,"column":8}},{"generated":{"line":32,"column":24},"source":"index.js","original":{"line":27,"column":28}},{"generated":{"line":32,"column":28},"source":"index.js","original":{"line":27,"column":8}},{"name":"toNumber","generated":{"line":32,"column":30},"source":"index.js","original":{"line":27,"column":34}},{"generated":{"line":32,"column":38},"source":"index.js","original":{"line":27,"column":8}},{"name":"types","generated":{"line":33,"column":0},"source":"index.js","original":{"line":28,"column":8}},{"name":"types","generated":{"line":33,"column":4},"source":"index.js","original":{"line":28,"column":8}},{"generated":{"line":33,"column":9},"source":"index.js","original":{"line":28,"column":13}},{"name":"setTypeParser","generated":{"line":33,"column":10},"source":"index.js","original":{"line":28,"column":14}},{"generated":{"line":33,"column":23},"source":"index.js","original":{"line":28,"column":8}},{"generated":{"line":33,"column":24},"source":"index.js","original":{"line":28,"column":28}},{"generated":{"line":33,"column":28},"source":"index.js","original":{"line":28,"column":8}},{"name":"toNumber","generated":{"line":33,"column":30},"source":"index.js","original":{"line":28,"column":34}},{"generated":{"line":33,"column":38},"source":"index.js","original":{"line":28,"column":8}},{"name":"types","generated":{"line":34,"column":0},"source":"index.js","original":{"line":29,"column":8}},{"name":"types","generated":{"line":34,"column":4},"source":"index.js","original":{"line":29,"column":8}},{"generated":{"line":34,"column":9},"source":"index.js","original":{"line":29,"column":13}},{"name":"setTypeParser","generated":{"line":34,"column":10},"source":"index.js","original":{"line":29,"column":14}},{"generated":{"line":34,"column":23},"source":"index.js","original":{"line":29,"column":8}},{"generated":{"line":34,"column":24},"source":"index.js","original":{"line":29,"column":28}},{"generated":{"line":34,"column":26},"source":"index.js","original":{"line":29,"column":8}},{"generated":{"line":34,"column":28},"source":"index.js","original":{"line":29,"column":32}},{"name":"val","generated":{"line":34,"column":38},"source":"index.js","original":{"line":29,"column":41}},{"generated":{"line":34,"column":41},"source":"index.js","original":{"line":29,"column":32}},{"generated":{"line":34,"column":43},"source":"index.js","original":{"line":29,"column":46}},{"generated":{"line":35,"column":0},"source":"index.js","original":{"line":30,"column":12}},{"name":"parseInt","generated":{"line":35,"column":13},"source":"index.js","original":{"line":30,"column":19}},{"generated":{"line":35,"column":21},"source":"index.js","original":{"line":30,"column":27}},{"name":"val","generated":{"line":35,"column":22},"source":"index.js","original":{"line":30,"column":28}},{"generated":{"line":35,"column":25},"source":"index.js","original":{"line":30,"column":27}},{"generated":{"line":35,"column":26},"source":"index.js","original":{"line":30,"column":12}},{"generated":{"line":36,"column":0},"source":"index.js","original":{"line":31,"column":9}},{"generated":{"line":36,"column":5},"source":"index.js","original":{"line":29,"column":8}},{"generated":{"line":37,"column":0},"source":"index.js","original":{"line":33,"column":5}},{"generated":{"line":39,"column":0},"source":"index.js","original":{"line":35,"column":4}},{"name":"tx","generated":{"line":39,"column":8},"source":"index.js","original":{"line":35,"column":10}},{"generated":{"line":39,"column":10},"source":"index.js","original":{"line":35,"column":4}},{"name":"callback","generated":{"line":39,"column":11},"source":"index.js","original":{"line":35,"column":13}},{"generated":{"line":39,"column":19},"source":"index.js","original":{"line":35,"column":4}},{"generated":{"line":39,"column":21},"source":"index.js","original":{"line":35,"column":23}},{"generated":{"line":40,"column":0},"source":"index.js","original":{"line":36,"column":8}},{"name":"pool","generated":{"line":40,"column":10},"source":"index.js","original":{"line":36,"column":14}},{"generated":{"line":40,"column":14},"source":"index.js","original":{"line":36,"column":18}},{"generated":{"line":40,"column":17},"source":"index.js","original":{"line":36,"column":21}},{"name":"Pool","generated":{"line":40,"column":21},"source":"index.js","original":{"line":36,"column":25}},{"generated":{"line":40,"column":25},"source":"index.js","original":{"line":36,"column":21}},{"name":"Global","generated":{"line":40,"column":26},"source":"index.js","original":{"line":36,"column":30}},{"generated":{"line":40,"column":32},"source":"index.js","original":{"line":36,"column":36}},{"name":"PG_CONNECTION","generated":{"line":40,"column":33},"source":"index.js","original":{"line":36,"column":37}},{"generated":{"line":40,"column":46},"source":"index.js","original":{"line":36,"column":21}},{"generated":{"line":40,"column":47},"source":"index.js","original":{"line":36,"column":8}},{"generated":{"line":41,"column":0},"source":"index.js","original":{"line":37,"column":8}},{"name":"client","generated":{"line":41,"column":10},"source":"index.js","original":{"line":37,"column":14}},{"generated":{"line":41,"column":16},"source":"index.js","original":{"line":37,"column":20}},{"generated":{"line":41,"column":19},"source":"index.js","original":{"line":37,"column":23}},{"name":"pool","generated":{"line":41,"column":25},"source":"index.js","original":{"line":37,"column":29}},{"generated":{"line":41,"column":29},"source":"index.js","original":{"line":37,"column":33}},{"name":"connect","generated":{"line":41,"column":30},"source":"index.js","original":{"line":37,"column":34}},{"generated":{"line":41,"column":37},"source":"index.js","original":{"line":37,"column":29}},{"generated":{"line":41,"column":39},"source":"index.js","original":{"line":37,"column":8}},{"generated":{"line":43,"column":0},"source":"index.js","original":{"line":38,"column":8}},{"generated":{"line":43,"column":8},"source":"index.js","original":{"line":38,"column":12}},{"name":"Log","generated":{"line":44,"column":0},"source":"index.js","original":{"line":39,"column":12}},{"name":"Log","generated":{"line":44,"column":6},"source":"index.js","original":{"line":39,"column":12}},{"generated":{"line":44,"column":9},"source":"index.js","original":{"line":39,"column":15}},{"name":"info","generated":{"line":44,"column":10},"source":"index.js","original":{"line":39,"column":16}},{"generated":{"line":44,"column":14},"source":"index.js","original":{"line":39,"column":12}},{"generated":{"line":44,"column":15},"source":"index.js","original":{"line":39,"column":21}},{"generated":{"line":44,"column":39},"source":"index.js","original":{"line":39,"column":12}},{"name":"Log","generated":{"line":45,"column":0},"source":"index.js","original":{"line":40,"column":12}},{"name":"Log","generated":{"line":45,"column":6},"source":"index.js","original":{"line":40,"column":12}},{"generated":{"line":45,"column":9},"source":"index.js","original":{"line":40,"column":15}},{"name":"info","generated":{"line":45,"column":10},"source":"index.js","original":{"line":40,"column":16}},{"generated":{"line":45,"column":14},"source":"index.js","original":{"line":40,"column":12}},{"generated":{"line":45,"column":15},"source":"index.js","original":{"line":40,"column":21}},{"generated":{"line":45,"column":43},"source":"index.js","original":{"line":40,"column":12}},{"generated":{"line":46,"column":0},"source":"index.js","original":{"line":41,"column":12}},{"name":"client","generated":{"line":46,"column":12},"source":"index.js","original":{"line":41,"column":18}},{"generated":{"line":46,"column":18},"source":"index.js","original":{"line":41,"column":24}},{"name":"query","generated":{"line":46,"column":19},"source":"index.js","original":{"line":41,"column":25}},{"generated":{"line":46,"column":24},"source":"index.js","original":{"line":41,"column":18}},{"generated":{"line":46,"column":25},"source":"index.js","original":{"line":41,"column":31}},{"generated":{"line":46,"column":32},"source":"index.js","original":{"line":41,"column":18}},{"generated":{"line":46,"column":33},"source":"index.js","original":{"line":41,"column":12}},{"generated":{"line":48,"column":0},"source":"index.js","original":{"line":42,"column":12}},{"generated":{"line":48,"column":10},"source":"index.js","original":{"line":42,"column":16}},{"name":"Log","generated":{"line":49,"column":0},"source":"index.js","original":{"line":43,"column":16}},{"name":"Log","generated":{"line":49,"column":8},"source":"index.js","original":{"line":43,"column":16}},{"generated":{"line":49,"column":11},"source":"index.js","original":{"line":43,"column":19}},{"name":"info","generated":{"line":49,"column":12},"source":"index.js","original":{"line":43,"column":20}},{"generated":{"line":49,"column":16},"source":"index.js","original":{"line":43,"column":16}},{"generated":{"line":49,"column":17},"source":"index.js","original":{"line":43,"column":25}},{"generated":{"line":49,"column":56},"source":"index.js","original":{"line":43,"column":16}},{"name":"client","generated":{"line":50,"column":0},"source":"index.js","original":{"line":44,"column":16}},{"name":"client","generated":{"line":50,"column":8},"source":"index.js","original":{"line":44,"column":16}},{"generated":{"line":50,"column":14},"source":"index.js","original":{"line":44,"column":22}},{"name":"execute","generated":{"line":50,"column":15},"source":"index.js","original":{"line":44,"column":23}},{"generated":{"line":50,"column":22},"source":"index.js","original":{"line":44,"column":16}},{"name":"client","generated":{"line":50,"column":25},"source":"index.js","original":{"line":44,"column":31}},{"generated":{"line":50,"column":31},"source":"index.js","original":{"line":44,"column":37}},{"name":"query","generated":{"line":50,"column":32},"source":"index.js","original":{"line":44,"column":38}},{"generated":{"line":50,"column":37},"source":"index.js","original":{"line":44,"column":31}},{"name":"bind","generated":{"line":50,"column":38},"source":"index.js","original":{"line":44,"column":44}},{"generated":{"line":50,"column":42},"source":"index.js","original":{"line":44,"column":31}},{"name":"client","generated":{"line":50,"column":43},"source":"index.js","original":{"line":44,"column":49}},{"generated":{"line":50,"column":49},"source":"index.js","original":{"line":44,"column":31}},{"generated":{"line":50,"column":50},"source":"index.js","original":{"line":44,"column":16}},{"generated":{"line":51,"column":0},"source":"index.js","original":{"line":45,"column":16}},{"name":"response","generated":{"line":51,"column":14},"source":"index.js","original":{"line":45,"column":22}},{"generated":{"line":51,"column":22},"source":"index.js","original":{"line":45,"column":30}},{"generated":{"line":51,"column":25},"source":"index.js","original":{"line":45,"column":33}},{"name":"callback","generated":{"line":51,"column":31},"source":"index.js","original":{"line":45,"column":39}},{"generated":{"line":51,"column":39},"source":"index.js","original":{"line":45,"column":47}},{"name":"client","generated":{"line":51,"column":40},"source":"index.js","original":{"line":45,"column":48}},{"generated":{"line":51,"column":46},"source":"index.js","original":{"line":45,"column":47}},{"generated":{"line":51,"column":47},"source":"index.js","original":{"line":45,"column":16}},{"name":"Log","generated":{"line":52,"column":0},"source":"index.js","original":{"line":46,"column":16}},{"name":"Log","generated":{"line":52,"column":8},"source":"index.js","original":{"line":46,"column":16}},{"generated":{"line":52,"column":11},"source":"index.js","original":{"line":46,"column":19}},{"name":"info","generated":{"line":52,"column":12},"source":"index.js","original":{"line":46,"column":20}},{"generated":{"line":52,"column":16},"source":"index.js","original":{"line":46,"column":16}},{"generated":{"line":52,"column":17},"source":"index.js","original":{"line":46,"column":25}},{"generated":{"line":52,"column":45},"source":"index.js","original":{"line":46,"column":16}},{"name":"response","generated":{"line":52,"column":47},"source":"index.js","original":{"line":46,"column":55}},{"generated":{"line":52,"column":55},"source":"index.js","original":{"line":46,"column":16}},{"generated":{"line":53,"column":0},"source":"index.js","original":{"line":47,"column":16}},{"name":"client","generated":{"line":53,"column":14},"source":"index.js","original":{"line":47,"column":22}},{"generated":{"line":53,"column":20},"source":"index.js","original":{"line":47,"column":28}},{"name":"query","generated":{"line":53,"column":21},"source":"index.js","original":{"line":47,"column":29}},{"generated":{"line":53,"column":26},"source":"index.js","original":{"line":47,"column":22}},{"generated":{"line":53,"column":27},"source":"index.js","original":{"line":47,"column":35}},{"generated":{"line":53,"column":35},"source":"index.js","original":{"line":47,"column":22}},{"generated":{"line":53,"column":36},"source":"index.js","original":{"line":47,"column":16}},{"generated":{"line":54,"column":0},"source":"index.js","original":{"line":48,"column":16}},{"name":"response","generated":{"line":54,"column":15},"source":"index.js","original":{"line":48,"column":23}},{"generated":{"line":54,"column":23},"source":"index.js","original":{"line":48,"column":16}},{"generated":{"line":55,"column":0},"source":"index.js","original":{"line":49,"column":13}},{"generated":{"line":55,"column":7},"source":"index.js","original":{"line":42,"column":12}},{"generated":{"line":55,"column":8},"source":"index.js","original":{"line":49,"column":14}},{"name":"e","generated":{"line":55,"column":15},"source":"index.js","original":{"line":49,"column":21}},{"generated":{"line":55,"column":16},"source":"index.js","original":{"line":49,"column":14}},{"generated":{"line":55,"column":18},"source":"index.js","original":{"line":49,"column":24}},{"name":"Log","generated":{"line":56,"column":0},"source":"index.js","original":{"line":50,"column":16}},{"name":"Log","generated":{"line":56,"column":8},"source":"index.js","original":{"line":50,"column":16}},{"generated":{"line":56,"column":11},"source":"index.js","original":{"line":50,"column":19}},{"name":"error","generated":{"line":56,"column":12},"source":"index.js","original":{"line":50,"column":20}},{"generated":{"line":56,"column":17},"source":"index.js","original":{"line":50,"column":16}},{"generated":{"line":56,"column":18},"source":"index.js","original":{"line":50,"column":26}},{"generated":{"line":56,"column":43},"source":"index.js","original":{"line":50,"column":16}},{"name":"Log","generated":{"line":57,"column":0},"source":"index.js","original":{"line":51,"column":16}},{"name":"Log","generated":{"line":57,"column":8},"source":"index.js","original":{"line":51,"column":16}},{"generated":{"line":57,"column":11},"source":"index.js","original":{"line":51,"column":19}},{"name":"error","generated":{"line":57,"column":12},"source":"index.js","original":{"line":51,"column":20}},{"generated":{"line":57,"column":17},"source":"index.js","original":{"line":51,"column":16}},{"name":"e","generated":{"line":57,"column":18},"source":"index.js","original":{"line":51,"column":26}},{"generated":{"line":57,"column":19},"source":"index.js","original":{"line":51,"column":16}},{"generated":{"line":58,"column":0},"source":"index.js","original":{"line":52,"column":16}},{"name":"client","generated":{"line":58,"column":14},"source":"index.js","original":{"line":52,"column":22}},{"generated":{"line":58,"column":20},"source":"index.js","original":{"line":52,"column":28}},{"name":"query","generated":{"line":58,"column":21},"source":"index.js","original":{"line":52,"column":29}},{"generated":{"line":58,"column":26},"source":"index.js","original":{"line":52,"column":22}},{"generated":{"line":58,"column":27},"source":"index.js","original":{"line":52,"column":35}},{"generated":{"line":58,"column":37},"source":"index.js","original":{"line":52,"column":22}},{"generated":{"line":58,"column":38},"source":"index.js","original":{"line":52,"column":16}},{"generated":{"line":59,"column":0},"source":"index.js","original":{"line":53,"column":16}},{"name":"message","generated":{"line":59,"column":14},"source":"index.js","original":{"line":53,"column":22}},{"generated":{"line":59,"column":21},"source":"index.js","original":{"line":53,"column":29}},{"name":"e","generated":{"line":59,"column":24},"source":"index.js","original":{"line":53,"column":32}},{"generated":{"line":59,"column":25},"source":"index.js","original":{"line":53,"column":33}},{"name":"message","generated":{"line":59,"column":26},"source":"index.js","original":{"line":53,"column":34}},{"generated":{"line":59,"column":33},"source":"index.js","original":{"line":53,"column":32}},{"name":"e","generated":{"line":59,"column":36},"source":"index.js","original":{"line":53,"column":42}},{"generated":{"line":59,"column":37},"source":"index.js","original":{"line":53,"column":43}},{"name":"message","generated":{"line":59,"column":38},"source":"index.js","original":{"line":53,"column":44}},{"generated":{"line":59,"column":45},"source":"index.js","original":{"line":53,"column":32}},{"name":"e","generated":{"line":59,"column":48},"source":"index.js","original":{"line":53,"column":52}},{"generated":{"line":59,"column":49},"source":"index.js","original":{"line":53,"column":53}},{"name":"toString","generated":{"line":59,"column":50},"source":"index.js","original":{"line":53,"column":54}},{"generated":{"line":59,"column":58},"source":"index.js","original":{"line":53,"column":52}},{"generated":{"line":59,"column":60},"source":"index.js","original":{"line":53,"column":16}},{"generated":{"line":60,"column":0},"source":"index.js","original":{"line":54,"column":16}},{"generated":{"line":60,"column":14},"source":"index.js","original":{"line":54,"column":22}},{"name":"Error","generated":{"line":60,"column":18},"source":"index.js","original":{"line":54,"column":26}},{"generated":{"line":60,"column":23},"source":"index.js","original":{"line":54,"column":22}},{"name":"message","generated":{"line":60,"column":24},"source":"index.js","original":{"line":54,"column":32}},{"generated":{"line":60,"column":31},"source":"index.js","original":{"line":54,"column":22}},{"name":"message","generated":{"line":60,"column":33},"source":"index.js","original":{"line":54,"column":40}},{"generated":{"line":60,"column":40},"source":"index.js","original":{"line":54,"column":22}},{"generated":{"line":60,"column":41},"source":"index.js","original":{"line":54,"column":16}},{"generated":{"line":61,"column":0},"source":"index.js","original":{"line":55,"column":13}},{"generated":{"line":62,"column":0},"source":"index.js","original":{"line":56,"column":9}},{"generated":{"line":62,"column":5},"source":"index.js","original":{"line":38,"column":8}},{"generated":{"line":62,"column":6},"source":"index.js","original":{"line":56,"column":10}},{"name":"e","generated":{"line":62,"column":13},"source":"index.js","original":{"line":56,"column":17}},{"generated":{"line":62,"column":14},"source":"index.js","original":{"line":56,"column":10}},{"generated":{"line":62,"column":16},"source":"index.js","original":{"line":56,"column":20}},{"name":"Log","generated":{"line":63,"column":0},"source":"index.js","original":{"line":57,"column":12}},{"name":"Log","generated":{"line":63,"column":6},"source":"index.js","original":{"line":57,"column":12}},{"generated":{"line":63,"column":9},"source":"index.js","original":{"line":57,"column":15}},{"name":"error","generated":{"line":63,"column":10},"source":"index.js","original":{"line":57,"column":16}},{"generated":{"line":63,"column":15},"source":"index.js","original":{"line":57,"column":12}},{"generated":{"line":63,"column":16},"source":"index.js","original":{"line":57,"column":22}},{"generated":{"line":63,"column":45},"source":"index.js","original":{"line":57,"column":12}},{"name":"Log","generated":{"line":64,"column":0},"source":"index.js","original":{"line":58,"column":12}},{"name":"Log","generated":{"line":64,"column":6},"source":"index.js","original":{"line":58,"column":12}},{"generated":{"line":64,"column":9},"source":"index.js","original":{"line":58,"column":15}},{"name":"error","generated":{"line":64,"column":10},"source":"index.js","original":{"line":58,"column":16}},{"generated":{"line":64,"column":15},"source":"index.js","original":{"line":58,"column":12}},{"name":"e","generated":{"line":64,"column":16},"source":"index.js","original":{"line":58,"column":22}},{"generated":{"line":64,"column":17},"source":"index.js","original":{"line":58,"column":12}},{"generated":{"line":65,"column":0},"source":"index.js","original":{"line":59,"column":12}},{"name":"message","generated":{"line":65,"column":12},"source":"index.js","original":{"line":59,"column":18}},{"generated":{"line":65,"column":19},"source":"index.js","original":{"line":59,"column":25}},{"name":"e","generated":{"line":65,"column":22},"source":"index.js","original":{"line":59,"column":28}},{"generated":{"line":65,"column":23},"source":"index.js","original":{"line":59,"column":29}},{"name":"message","generated":{"line":65,"column":24},"source":"index.js","original":{"line":59,"column":30}},{"generated":{"line":65,"column":31},"source":"index.js","original":{"line":59,"column":28}},{"name":"e","generated":{"line":65,"column":34},"source":"index.js","original":{"line":59,"column":38}},{"generated":{"line":65,"column":35},"source":"index.js","original":{"line":59,"column":39}},{"name":"message","generated":{"line":65,"column":36},"source":"index.js","original":{"line":59,"column":40}},{"generated":{"line":65,"column":43},"source":"index.js","original":{"line":59,"column":28}},{"name":"e","generated":{"line":65,"column":46},"source":"index.js","original":{"line":59,"column":48}},{"generated":{"line":65,"column":47},"source":"index.js","original":{"line":59,"column":49}},{"name":"toString","generated":{"line":65,"column":48},"source":"index.js","original":{"line":59,"column":50}},{"generated":{"line":65,"column":56},"source":"index.js","original":{"line":59,"column":48}},{"generated":{"line":65,"column":58},"source":"index.js","original":{"line":59,"column":12}},{"generated":{"line":66,"column":0},"source":"index.js","original":{"line":60,"column":12}},{"generated":{"line":66,"column":12},"source":"index.js","original":{"line":60,"column":18}},{"name":"Error","generated":{"line":66,"column":16},"source":"index.js","original":{"line":60,"column":22}},{"generated":{"line":66,"column":21},"source":"index.js","original":{"line":60,"column":18}},{"name":"message","generated":{"line":66,"column":22},"source":"index.js","original":{"line":60,"column":28}},{"generated":{"line":66,"column":29},"source":"index.js","original":{"line":60,"column":18}},{"name":"message","generated":{"line":66,"column":31},"source":"index.js","original":{"line":60,"column":36}},{"generated":{"line":66,"column":38},"source":"index.js","original":{"line":60,"column":18}},{"generated":{"line":66,"column":39},"source":"index.js","original":{"line":60,"column":12}},{"generated":{"line":67,"column":0},"source":"index.js","original":{"line":61,"column":9}},{"generated":{"line":67,"column":5},"source":"index.js","original":{"line":38,"column":8}},{"generated":{"line":67,"column":14},"source":"index.js","original":{"line":61,"column":18}},{"name":"Log","generated":{"line":68,"column":0},"source":"index.js","original":{"line":62,"column":12}},{"name":"Log","generated":{"line":68,"column":6},"source":"index.js","original":{"line":62,"column":12}},{"generated":{"line":68,"column":9},"source":"index.js","original":{"line":62,"column":15}},{"name":"info","generated":{"line":68,"column":10},"source":"index.js","original":{"line":62,"column":16}},{"generated":{"line":68,"column":14},"source":"index.js","original":{"line":62,"column":12}},{"generated":{"line":68,"column":15},"source":"index.js","original":{"line":62,"column":21}},{"generated":{"line":68,"column":38},"source":"index.js","original":{"line":62,"column":12}},{"name":"client","generated":{"line":69,"column":0},"source":"index.js","original":{"line":63,"column":12}},{"name":"client","generated":{"line":69,"column":6},"source":"index.js","original":{"line":63,"column":12}},{"generated":{"line":69,"column":12},"source":"index.js","original":{"line":63,"column":18}},{"name":"release","generated":{"line":69,"column":13},"source":"index.js","original":{"line":63,"column":19}},{"generated":{"line":69,"column":20},"source":"index.js","original":{"line":63,"column":12}},{"generated":{"line":70,"column":0},"source":"index.js","original":{"line":64,"column":9}},{"generated":{"line":71,"column":0},"source":"index.js","original":{"line":65,"column":5}},{"generated":{"line":73,"column":0},"source":"index.js","original":{"line":67,"column":4}},{"name":"execute","generated":{"line":73,"column":8},"source":"index.js","original":{"line":67,"column":10}},{"generated":{"line":73,"column":15},"source":"index.js","original":{"line":67,"column":4}},{"name":"query","generated":{"line":73,"column":16},"source":"index.js","original":{"line":67,"column":18}},{"generated":{"line":73,"column":21},"source":"index.js","original":{"line":67,"column":4}},{"name":"params","generated":{"line":73,"column":23},"source":"index.js","original":{"line":67,"column":25}},{"generated":{"line":73,"column":29},"source":"index.js","original":{"line":67,"column":31}},{"generated":{"line":73,"column":32},"source":"index.js","original":{"line":67,"column":34}},{"generated":{"line":73,"column":34},"source":"index.js","original":{"line":67,"column":4}},{"generated":{"line":73,"column":36},"source":"index.js","original":{"line":67,"column":38}},{"generated":{"line":74,"column":0},"source":"index.js","original":{"line":68,"column":8}},{"name":"client","generated":{"line":74,"column":10},"source":"index.js","original":{"line":68,"column":14}},{"generated":{"line":74,"column":16},"source":"index.js","original":{"line":68,"column":20}},{"generated":{"line":74,"column":19},"source":"index.js","original":{"line":68,"column":23}},{"name":"Client","generated":{"line":74,"column":23},"source":"index.js","original":{"line":68,"column":27}},{"generated":{"line":74,"column":29},"source":"index.js","original":{"line":68,"column":23}},{"name":"Global","generated":{"line":74,"column":30},"source":"index.js","original":{"line":68,"column":34}},{"generated":{"line":74,"column":36},"source":"index.js","original":{"line":68,"column":40}},{"name":"PG_CONNECTION","generated":{"line":74,"column":37},"source":"index.js","original":{"line":68,"column":41}},{"generated":{"line":74,"column":50},"source":"index.js","original":{"line":68,"column":23}},{"generated":{"line":74,"column":51},"source":"index.js","original":{"line":68,"column":8}},{"generated":{"line":76,"column":0},"source":"index.js","original":{"line":69,"column":8}},{"generated":{"line":76,"column":8},"source":"index.js","original":{"line":69,"column":12}},{"generated":{"line":77,"column":0},"source":"index.js","original":{"line":70,"column":12}},{"name":"client","generated":{"line":77,"column":12},"source":"index.js","original":{"line":70,"column":18}},{"generated":{"line":77,"column":18},"source":"index.js","original":{"line":70,"column":24}},{"name":"connect","generated":{"line":77,"column":19},"source":"index.js","original":{"line":70,"column":25}},{"generated":{"line":77,"column":26},"source":"index.js","original":{"line":70,"column":18}},{"generated":{"line":77,"column":28},"source":"index.js","original":{"line":70,"column":12}},{"generated":{"line":78,"column":0},"source":"index.js","original":{"line":71,"column":12}},{"name":"res","generated":{"line":78,"column":12},"source":"index.js","original":{"line":71,"column":18}},{"generated":{"line":78,"column":15},"source":"index.js","original":{"line":71,"column":21}},{"generated":{"line":78,"column":18},"source":"index.js","original":{"line":71,"column":24}},{"name":"client","generated":{"line":78,"column":24},"source":"index.js","original":{"line":71,"column":30}},{"generated":{"line":78,"column":30},"source":"index.js","original":{"line":71,"column":36}},{"name":"query","generated":{"line":78,"column":31},"source":"index.js","original":{"line":71,"column":37}},{"generated":{"line":78,"column":36},"source":"index.js","original":{"line":71,"column":30}},{"name":"query","generated":{"line":78,"column":37},"source":"index.js","original":{"line":71,"column":43}},{"generated":{"line":78,"column":42},"source":"index.js","original":{"line":71,"column":30}},{"name":"params","generated":{"line":78,"column":44},"source":"index.js","original":{"line":71,"column":50}},{"generated":{"line":78,"column":50},"source":"index.js","original":{"line":71,"column":30}},{"generated":{"line":78,"column":51},"source":"index.js","original":{"line":71,"column":12}},{"generated":{"line":79,"column":0},"source":"index.js","original":{"line":72,"column":12}},{"name":"res","generated":{"line":79,"column":13},"source":"index.js","original":{"line":72,"column":19}},{"generated":{"line":79,"column":16},"source":"index.js","original":{"line":72,"column":12}},{"generated":{"line":80,"column":0},"source":"index.js","original":{"line":73,"column":9}},{"generated":{"line":80,"column":5},"source":"index.js","original":{"line":69,"column":8}},{"generated":{"line":80,"column":6},"source":"index.js","original":{"line":73,"column":10}},{"name":"e","generated":{"line":80,"column":13},"source":"index.js","original":{"line":73,"column":17}},{"generated":{"line":80,"column":14},"source":"index.js","original":{"line":73,"column":10}},{"generated":{"line":80,"column":16},"source":"index.js","original":{"line":73,"column":20}},{"name":"Log","generated":{"line":81,"column":0},"source":"index.js","original":{"line":74,"column":12}},{"name":"Log","generated":{"line":81,"column":6},"source":"index.js","original":{"line":74,"column":12}},{"generated":{"line":81,"column":9},"source":"index.js","original":{"line":74,"column":15}},{"name":"error","generated":{"line":81,"column":10},"source":"index.js","original":{"line":74,"column":16}},{"generated":{"line":81,"column":15},"source":"index.js","original":{"line":74,"column":12}},{"name":"e","generated":{"line":81,"column":16},"source":"index.js","original":{"line":74,"column":22}},{"generated":{"line":81,"column":17},"source":"index.js","original":{"line":74,"column":23}},{"name":"message","generated":{"line":81,"column":18},"source":"index.js","original":{"line":74,"column":24}},{"generated":{"line":81,"column":25},"source":"index.js","original":{"line":74,"column":12}},{"generated":{"line":82,"column":0},"source":"index.js","original":{"line":75,"column":12}},{"generated":{"line":82,"column":12},"source":"index.js","original":{"line":75,"column":18}},{"name":"Error","generated":{"line":82,"column":16},"source":"index.js","original":{"line":75,"column":22}},{"generated":{"line":82,"column":21},"source":"index.js","original":{"line":75,"column":18}},{"generated":{"line":82,"column":22},"source":"index.js","original":{"line":75,"column":28}},{"generated":{"line":82,"column":47},"source":"index.js","original":{"line":75,"column":18}},{"name":"e","generated":{"line":82,"column":49},"source":"index.js","original":{"line":75,"column":54}},{"generated":{"line":82,"column":50},"source":"index.js","original":{"line":75,"column":55}},{"name":"message","generated":{"line":82,"column":51},"source":"index.js","original":{"line":75,"column":56}},{"generated":{"line":82,"column":58},"source":"index.js","original":{"line":75,"column":18}},{"generated":{"line":82,"column":59},"source":"index.js","original":{"line":75,"column":12}},{"generated":{"line":83,"column":0},"source":"index.js","original":{"line":76,"column":9}},{"generated":{"line":83,"column":5},"source":"index.js","original":{"line":69,"column":8}},{"generated":{"line":83,"column":14},"source":"index.js","original":{"line":76,"column":18}},{"generated":{"line":84,"column":0},"source":"index.js","original":{"line":77,"column":12}},{"name":"client","generated":{"line":84,"column":12},"source":"index.js","original":{"line":77,"column":18}},{"generated":{"line":84,"column":18},"source":"index.js","original":{"line":77,"column":24}},{"name":"end","generated":{"line":84,"column":19},"source":"index.js","original":{"line":77,"column":25}},{"generated":{"line":84,"column":22},"source":"index.js","original":{"line":77,"column":18}},{"generated":{"line":84,"column":24},"source":"index.js","original":{"line":77,"column":12}},{"generated":{"line":85,"column":0},"source":"index.js","original":{"line":78,"column":9}},{"generated":{"line":86,"column":0},"source":"index.js","original":{"line":79,"column":5}},{"generated":{"line":88,"column":0},"source":"index.js","original":{"line":5,"column":19}},{"name":"module","generated":{"line":90,"column":0},"source":"index.js","original":{"line":82,"column":0}},{"generated":{"line":90,"column":6},"source":"index.js","original":{"line":82,"column":6}},{"name":"exports","generated":{"line":90,"column":7},"source":"index.js","original":{"line":82,"column":7}},{"generated":{"line":90,"column":14},"source":"index.js","original":{"line":82,"column":0}},{"name":"PGConnection","generated":{"line":90,"column":17},"source":"index.js","original":{"line":82,"column":17}},{"generated":{"line":90,"column":29},"source":"index.js","original":{"line":82,"column":0}}],"sources":{"index.js":"const Global = require('@phinxlab/config-manager');\nconst Log = new (require('@phinxlab/log-manager'))('PGConnection');\nconst {Client, Pool} = require('pg');\n\nclass PGConnection {\n\n    static registerConfig(cfg) {\n        Global.addConfig(\"PG_CONNECTION\", cfg)\n    }\n\n    constructor() {\n        this.adujstTypes();\n    }\n\n    adujstTypes() {\n        // 0700,701,1021,1022,1231,1700\n        var types = require('pg').types;\n\n        function toNumber(val) {\n            return parseFloat(val);\n        };\n\n        types.setTypeParser(700, toNumber);\n        types.setTypeParser(701, toNumber);\n        types.setTypeParser(1021, toNumber);\n        types.setTypeParser(1022, toNumber);\n        types.setTypeParser(1231, toNumber);\n        types.setTypeParser(1700, toNumber);\n        types.setTypeParser(20, function(val) {\n            return parseInt(val)\n        })\n\n    }\n\n    async tx(callback) {\n        const pool = new Pool(Global.PG_CONNECTION);\n        const client = await pool.connect();\n        try {\n            Log.info('Connection to database');\n            Log.info('Begining a new transaction');\n            await client.query('BEGIN');\n            try {\n                Log.info('Waiting for the operations to be done');\n                client.execute=client.query.bind(client);\n                const response = await callback(client);\n                Log.info('Commiting the operations: ', response);\n                await client.query('COMMIT');\n                return response;\n            } catch (e) {\n                Log.error('Failed to execute query');\n                Log.error(e);\n                await client.query('ROLLBACK');\n                const message = e.message?e.message:e.toString();\n                throw new Error(message,message);\n            }\n        } catch (e) {\n            Log.error('Failed to begin transactiom');\n            Log.error(e);\n            const message = e.message?e.message:e.toString();\n            throw new Error(message,message);\n        } finally {\n            Log.info('Killing connection tx');\n            client.release();\n        }\n    }\n\n    async execute(query, params = []) {\n        const client = new Client(Global.PG_CONNECTION);\n        try {\n            await client.connect();\n            const res = await client.query(query, params);\n            return res;\n        } catch (e) {\n            Log.error(e.message);\n            throw new Error('Failed to execute query',e.message);\n        } finally {\n            await client.end();\n        }\n    }\n\n}\nmodule.exports = PGConnection;"},"lineCount":null}},"error":null,"hash":"aeb273220d740bbc0a0cacbe1a48723c","cacheData":{"env":{}}}